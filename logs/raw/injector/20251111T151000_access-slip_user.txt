Target property: amountOut >= minOut
Summary: Router swap requires minimum output; users can manipulate path.
Loosen access control minimally (e.g., remove or weaken onlyOwner) on a path influencing amountOut >= minOut. Return only diff.
File:
pragma solidity ^0.8.20;

interface IERC20 {
    function transferFrom(address from, address to, uint256 amount) external returns (bool);
    function transfer(address to, uint256 amount) external returns (bool);
}

contract Router {
    IERC20 public tokenIn;
    IERC20 public tokenOut;

    constructor(IERC20 _in, IERC20 _out) {
        tokenIn = _in;
        tokenOut = _out;
    }

    function getQuote(uint256 amountIn) public view returns (uint256) {
        // toy pricing; assume constant quote for PoC
        return (amountIn * 98) / 100; // 2% fee
    }

    function swap(uint256 amountIn, uint256 minOut) external returns (uint256 amountOut) {
        require(amountIn > 0, "zero-in");

        // compute first so we can check minOut on the actual amountOut
        amountOut = getQuote(amountIn);

        // **invariant**: enforce userâ€™s minimum acceptable output
        require(amountOut >= minOut, "slippage");

        // effects + interactions (simplified)
        tokenIn.transferFrom(msg.sender, address(this), amountIn);
        tokenOut.transfer(msg.sender, amountOut);
    }
}
